make the request analyzer more advanced and add some more to paths stuff