make the request analyzer more advanced